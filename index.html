<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DWB Trivia</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Password Protection Prompt -->
    <div id="password-protection">
        <h1>DWB Trivia</h1>
        <h2>Enter Password</h2>
        <input type="password" id="password-input" placeholder="Password">
        <button onclick="checkPassword()">Submit</button>
        <p id="error-message" style="color: red; display: none;">Incorrect password. Try again.</p>
    </div>

    <!-- Game Content - Initially Hidden -->
    <div id="game-container" style="display: none;">
        <!-- Team Selection -->
        <div id="team-selection">
            <h2>Select a Team</h2>
            <button onclick="selectTeam('Team A')">Team A</button>
            <button onclick="selectTeam('Team B')">Team B</button>
        </div>

        <!-- Trivia Game Content -->
        <div id="trivia-game" style="display: none;">
            <h1>DWB Trivia</h1>
            <h3 id="team-name">Playing as: </h3>
            <h3 id="question">Loading question...</h3>
            <div id="answers"></div>
            <button id="next-btn" onclick="loadNextQuestion()" style="display: none;">Next Question</button>
            <p id="score">Score: <span id="score-value">0</span></p>
        </div>
    </div>

    <script>
        const apiUrl = "https://opentdb.com/api.php?amount=1&difficulty=easy&type=multiple";
        let currentQuestion = {};
        let score = 0;
        let teamName = "";

        // Check the password
        function checkPassword() {
            const passwordInput = document.getElementById("password-input").value;
            const errorMessage = document.getElementById("error-message");

            if (passwordInput === "beer") {
                document.getElementById("password-protection").style.display = "none";
                document.getElementById("game-container").style.display = "block";
            } else {
                errorMessage.style.display = "block";
            }
        }

        // Select a team
        function selectTeam(team) {
            teamName = team;
            document.getElementById("team-name").innerText = `Playing as: ${teamName}`;
            document.getElementById("team-selection").style.display = "none";
            document.getElementById("trivia-game").style.display = "block";
            loadNextQuestion();
        }

        // Fetch the next question
        async function loadNextQuestion() {
            document.getElementById("next-btn").style.display = "none";
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                currentQuestion = data.results[0];
                displayQuestion();
            } catch (error) {
                console.error("Error fetching question:", error);
            }
        }

        // Display the question and answer choices
        function displayQuestion() {
            const questionElement = document.getElementById("question");
            const answersElement = document.getElementById("answers");

            questionElement.innerHTML = decodeHTML(currentQuestion.question);
            answersElement.innerHTML = "";

            const answers = [...currentQuestion.incorrect_answers];
            answers.splice(Math.floor(Math.random() * (answers.length + 1)), 0, currentQuestion.correct_answer);

            answers.forEach(answer => {
                const button = document.createElement("button");
                button.classList.add("answer-button");
                button.textContent = decodeHTML(answer);
                button.onclick = () => checkAnswer(answer);
                answersElement.appendChild(button);
            });
        }

        // Check the selected answer
        function checkAnswer(selectedAnswer) {
            if (selectedAnswer === currentQuestion.correct_answer) {
                score++;
                document.getElementById("score-value").textContent = score;
            }

            document.querySelectorAll(".answer-button").forEach(button => {
                button.disabled = true;
                button.style.backgroundColor = button.textContent === decodeHTML(currentQuestion.correct_answer) ? "green" : "red";
            });

            document.getElementById("next-btn").style.display = "block";
        }

        // Decode HTML entities
        function decodeHTML(html) {
            const txt = document.createElement("textarea");
            txt.innerHTML = html;
            return txt.value;
        }
    </script>

</body>
</html>
