<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeopardy Trivia Game</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Password Protection Prompt -->
    <div id="password-protection" style="display: flex; justify-content: center; align-items: center; height: 100vh; flex-direction: column;">
        <h2>Enter Password</h2>
        <input type="password" id="password-input" placeholder="Password">
        <button onclick="checkPassword()">Submit</button>
        <p id="error-message" style="color: red; display: none;">Incorrect password. Try again.</p>
    </div>

    <!-- Game Content - Initially Hidden -->
    <div id="game-container" style="display: none;">
        <!-- Team Selection -->
        <div id="team-selection">
            <h2>Select a Team</h2>
            <button onclick="selectTeam('Team A')">Team A</button>
            <button onclick="selectTeam('Team B')">Team B</button>
        </div>

        <!-- Jeopardy Game Board -->
        <div id="jeopardy-board" style="display: none;">
            <h3 id="team-name">Playing as: </h3>
            <h2>Jeopardy Game Board</h2>
            <div id="board" class="board">
                <!-- Categories and Questions will be populated here -->
            </div>
            <div id="question-modal" style="display: none;">
                <h3 id="question-text"></h3>
                <div id="answer-buttons"></div>
                <button onclick="closeQuestion()">Close</button>
            </div>
            <p id="score">Score: <span id="score-value">0</span></p>
        </div>
    </div>

    <script>
        const categories = ["General Knowledge", "Science & Nature", "Entertainment"];
        let score = 0;
        let teamName = "";
        const boardElement = document.getElementById("board");

        // Check the password
        function checkPassword() {
            const passwordInput = document.getElementById("password-input").value;
            const errorMessage = document.getElementById("error-message");

            if (passwordInput === "beer") {
                document.getElementById("password-protection").style.display = "none";
                document.getElementById("game-container").style.display = "block";
            } else {
                errorMessage.style.display = "block";
            }
        }

        // Select a team
        function selectTeam(team) {
            teamName = team;
            document.getElementById("team-name").innerText = `Playing as: ${teamName}`;
            document.getElementById("team-selection").style.display = "none";
            document.getElementById("jeopardy-board").style.display = "block";
            loadGameBoard();
        }

        // Load game board with categories and questions
        async function loadGameBoard() {
            for (const category of categories) {
                const column = document.createElement("div");
                column.classList.add("column");
                const categoryHeader = document.createElement("h3");
                categoryHeader.innerText = category;
                column.appendChild(categoryHeader);

                for (let i = 100; i <= 500; i += 100) {
                    const cell = document.createElement("button");
                    cell.innerText = `$${i}`;
                    cell.classList.add("cell");
                    cell.onclick = () => loadQuestion(category, i);
                    column.appendChild(cell);
                }
                boardElement.appendChild(column);
            }
        }

        // Load a question from the API based on category and difficulty
        async function loadQuestion(category, value) {
            const apiUrl = `https://opentdb.com/api.php?amount=1&category=${getCategoryId(category)}&difficulty=easy&type=multiple`;
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                const questionData = data.results[0];
                displayQuestion(questionData, value);
            } catch (error) {
                console.error("Error fetching question:", error);
            }
        }

        // Display question in modal
        function displayQuestion(questionData, value) {
            document.getElementById("question-modal").style.display = "block";
            document.getElementById("question-text").innerText = decodeHTML(questionData.question);
            const answers = [...questionData.incorrect_answers];
            answers.splice(Math.floor(Math.random() * (answers.length + 1)), 0, questionData.correct_answer);

            const answerButtons = document.getElementById("answer-buttons");
            answerButtons.innerHTML = "";
            answers.forEach(answer => {
                const button = document.createElement("button");
                button.innerText = decodeHTML(answer);
                button.onclick = () => checkAnswer(answer, questionData.correct_answer, value);
                answerButtons.appendChild(button);
            });
        }

        // Check if the answer is correct
        function checkAnswer(selectedAnswer, correctAnswer, value) {
            if (selectedAnswer === correctAnswer) {
                score += value;
                document.getElementById("score-value").textContent = score;
            }
            closeQuestion();
        }

        // Close question modal
        function closeQuestion() {
            document.getElementById("question-modal").style.display = "none";
        }

        // Map categories to OpenTDB IDs
        function getCategoryId(category) {
            const categoryMap = {
                "General Knowledge": 9,
                "Science & Nature": 17,
                "Entertainment": 11
            };
            return categoryMap[category];
        }

        // Decode HTML entities in API questions
        function decodeHTML(html) {
            const txt = document.createElement("textarea");
            txt.innerHTML = html;
            return txt.value;
        }
    </script>

</body>
</html>
